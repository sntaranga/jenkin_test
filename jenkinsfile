pipeline {
    agent any

	options {
        skipDefaultCheckout()
    }

    stages {
        stage('Checkout and maven build') {
            
            stages {
                stage('thinuja.com') {
                    steps { mystep('checkout')}
                }
                stage('Maven build') {
                    steps { mystep('build') }
                }
                stage('thin build') {
                    steps { mystep('thin build') }
                }
            }
            post { always { cleanWs() } } 
        }
        parallel {
               stage('p1') {
                     stage('p1s1') {
                          steps('p1s1')
                     }
                     stage('p1s2') {
                          steps('p1s2')
                     }
               }
               stage('p2') {
                     stage('p2s1') {
                          steps('p2s1')
                     }
                     stage('p2s2') {
                          steps('p2s2')
                     }
               }
        }
        stage('Docker build and publish') {
            agent any
            steps { mystep('B A P') }
            post { always { cleanWs() } }
        }
    }
}
def mystep(String name){
	println 'hellow $name'
	sleep(20) 
}
